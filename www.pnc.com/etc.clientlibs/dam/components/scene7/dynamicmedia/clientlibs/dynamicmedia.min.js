var pncDynamicMediaPlayer=function(){function n(){$(".s7dm-dynamic-media").each(function(){p($(this),pncDynamicMediaPlayer.captionManager.onVideoInit)})}function p(a,e){var g=a.attr("id"),d=S7dmUtils[g],c=a.data("asset-type"),f=a.data("mode"),m=a.data("stagesize");"undefined"!=typeof d&&null!=d&&(d.dispose(),S7dmUtils[g]=null,a.removeClass("s7responsiveViewer"));a.html("");if(d=a.data("viewer-type")){c=a.data("asset-path");f=a.data("asset-type");var k=a.data("viewer-type"),l=a.data("imageserver"),
n=a.data("videoserver"),p=a.data("contenturl"),h=a.data("config"),r=a.data("wcmdisabled"),t=a.data("stagesize"),u=a.data("viewermodifiers"),v=a.data("dms7");l={asset:c,serverurl:l,contenturl:p};u&&$.extend(l,q(u));r||""==r||(l.asset+="?cache\x3doff");t&&(l.stagesize=t);"FlyoutViewer"==k&&(l.imagereload="1,breakpoint,100;320;480");0!=c.indexOf("/")&&(l.aemmode="0");if(0<=k.indexOf("Video")||0<=k.indexOf("Mixed"))if(l.videoserverurl=n,"video"==f||"undefined"!=typeof v)l.playback="native",l.progressivebitrate=
"20000";"undefined"!=typeof h&&0<h.length&&(l.config=h.split("|")[0]);c={containerId:a.attr("id"),params:l};"FlyoutViewer"==d&&m||a.addClass("s7responsiveViewer");d=new s7viewers[d](c);"undefined"!=typeof Granite&&"undefined"!=typeof Granite.I18n&&d.setLocalizedTexts(b());S7dmUtils[g]=d;d.onInitComplete=e;d.init()}else"image"===c&&(a.data("breakpoints")||"smartcrop"==f?(d=a.data("imagepreset"),f=a.data("imageserver"),e=a.data("alt"),c=a.data("urlmodifiers"),g=$("\x3cdiv\x3e",{"class":"s7responsiveContainer"}),
m=a.attr("id")+"_resp",f={id:m,src:f+a.data("asset-path"),"class":"fluidimage","data-mode":a.data("mode"),"data-breakpoints":a.data("breakpoints")},d&&(f.src+="?$"+d+"$"),c&&(f.src+=(d?"\x26":"?")+c),d=$("\x3cimg\x3e",f),e&&d.attr("alt",e),g.append(d),a.append(g),s7responsiveImage(document.getElementById(m))):(d=a.data("stagesize"),g=a.data("linkurl"),m=a.data("linktarget"),e=a.data("alt"),c=a.data("imagepreset"),k=a.data("imageserver"),f=a.data("urlmodifiers"),k={src:k+a.data("asset-path")},c&&(k.src+=
"?$"+c+"$"),f&&(k.src+=(c?"\x26":"?")+f),d&&(d=d.split(","),k.width=d[0],1<d.length&&(k.height=d[1])),d=$("\x3cimg\x3e",k),g?(g={href:g,target:m},e&&(g.alt=e,g.title=e,d.attr("alt",e)),e=$("\x3ca\x3e",g),e.append(d),a.append(e)):(e&&d.attr("alt",e),a.append(d))))}function h(){console.log("S7Viewer is missing")}function q(a){var c={};if(a){a=a.split("\x26");for(var b=0;b<a.length;b++)if(0<a[b].indexOf("\x3d")){var d=a[b].substring(0,a[b].indexOf("\x3d")),h=a[b].substring(a[b].indexOf("\x3d")+1);c[d]=
h}}return c}function b(){var a={},c=Granite.I18n.getLocale(),b=s7sdk_i18n.localizedText,d={},h;for(h in b){var f=b[h],m;for(m in f)d[h+"."+m]=f[m]}a[c]=d;a.defaultLocale=Granite.I18n.getLocale();return a}var c={BasicZoomViewer:"html5/js/BasicZoomViewer.js",FlyoutViewer:"html5/js/FlyoutViewer.js",MixedMediaViewer:"html5/js/MixedMediaViewer.js",SpinViewer:"html5/js/SpinViewer.js",VideoViewer:"html5/js/VideoViewer.js",ZoomViewer:"html5/js/ZoomViewer.js",ZoomVerticalViewer:"html5/js/ZoomVerticalViewer.js",
Responsive:"libs/responsive_image.js"};$(document).ready(function(){if(0<$(".s7dm-dynamic-media").length){var a=new S7dmUtils.Viewer,b=$(".s7dm-dynamic-media").data("viewer-path");a.load(c,b).ready({success:n,fail:h})}});return{initPlayer:function(a,b){p(a,b)}}}.call(this);
pncDynamicMediaPlayer.captionManager=function(){function n(b){b=b.data("caption-language-map");var c={};b&&b.split(",").forEach(function(a,b){(a=a.split("\x3d"))&&1<a.length&&q.hasOwnProperty(a[0])&&(c[a[0]]=a[1])});return c}function p(b){var c="",a=n(b),e,g=0;for(e in a)c+="\x3cli\x3e\x3cbutton id\x3d'subtitles-{{item_lang}}' class\x3d'subtitles-button' lang\x3d{{item_lang}} value\x3d'{{item_text}}' data-state\x3d'inactive'\x3e{{item_text}}\x3c/button\x3e\x3c/li\x3e".replace(/{{item_lang}}/g,e).replace(/{{item_text}}/g,
q[e]),g++;1<g&&(c="\x3cdiv class\x3d'subtitles-menu-dropdown'\x3e\x3cul class\x3d'subtitles-menu'\x3e\x3cli\x3e\x3cbutton id\x3d'subtitles-off' class\x3d'subtitles-button' value\x3d'Off' data-state\x3d'inactive'\x3eOff\x3c/button\x3e\x3c/li\x3e{{menu_tems}}\x3c/ul\x3e\x3c/div\x3e".replace("{{menu_tems}}",c),$(".s7button.s7closedcaptionbutton",b).html(c),c=b.data("caption-lang-selected"),$(".s7closedcaptionbutton .subtitles-button[lang\x3d"+c+"]",b).attr("data-state","active"))}function h(){var b=
window.location.pathname.substr(1,2).toUpperCase();return q.hasOwnProperty(b)?b:"EN"}var q={EN:"English",ES:"Spanish"};$(document).ready(function(){$(".s7dm-dynamic-media").on("click",".s7closedcaptionbutton .subtitles-button",function(){var b=$(this).parents(".s7dm-dynamic-media"),c=$(this).attr("lang"),a=b.data("caption-lang-selected"),e=$(".s7closedcaptionbutton",b)[0].getAttribute("selected");c&&($("li #subtitles-off",b).attr("data-state","inactive"),c!=a?pncDynamicMediaPlayer.captionManager.changeCaptionLanguage(b,
c):"active"==$(this).attr("data-state")&&"false"==e&&$(this).parents(".s7closedcaptionbutton").trigger("click"))});$(".s7dm-dynamic-media").on("mouseenter",".s7closedcaptionbutton .subtitles-menu-dropdown",function(){var b=$(this).parents(".s7dm-dynamic-media");$(".s7tooltip",b).hide()})});return{changeCaptionLanguage:function(b,c,a){langauge=c.toUpperCase();var e=n(b)[c];e="caption\x3d{subtitle-filename},1".replace("{subtitle-filename}",e);a&&(e=e.replace(",1",""));b.data("caption-lang-selected",
c);b.data("viewermodifiers",e);pncDynamicMediaPlayer.initPlayer(b,pncDynamicMediaPlayer.captionManager.onVideoInit)},setupCaptionMenu:p,onVideoInit:function(){var b=$("#"+this.containerId),c=h(),a=n(b);"EN"!=c&&a.hasOwnProperty(c)&&pncDynamicMediaPlayer.captionManager.changeCaptionLanguage(b,c,!0);c=$(b[0]).find(".s7closedcaptionbutton");"true"!=c.data("caption-menu-initialized")&&($(b[0]).data("caption-lang-selected")||$(b[0]).data("caption-lang-selected",h()),p(b),c.data("caption-menu-initialized",
"true"))}}}();